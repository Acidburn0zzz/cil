(class file (read write open))
(classcommon file file)

(user sysadm)
(role sysadm_r)
(userrole sysadm sysadm_r)

(type new)
(type foo)
(type bar)
(type foobar)

(common file
	(ioctl read write create getattr setattr lock))

(sensitivity s0)
(sensitivity s1)
(sensitivity s2)
(sensitivity s3)
(sensitivity s4)

(category c0)
(categoryalias c0 cat)
(category c1)
(category c2)
(category c3)
(category c4)
(category c5)
(category c6)
(category c7)
(category c8)
(category c9)
(category c10)
(category c11)
(category c12)
(category c13)
(category c14)
(category c15)
(category c16)
(category c17)
(category c18)
(category c19)
(category c20)
(category c21)
(category c22)
(category c23)
(categoryorder (c0 c1))
(categoryorder (c1 c2 c3))
(categoryorder (c5 c6 c7))
(categoryorder (c8 c9 c10))
(categoryorder (c4 c5))
(categoryorder (c7 c8))
(categoryorder (c3 c4))
(categoryorder (c12 c13 c14))
(categoryorder (c11 c12))
(categoryorder (c10 c11))
(categoryorder (c14 c15 c16 c17 c18))
(categoryorder (c19 c20))
(categoryorder (c21 c22))
(categoryorder (c20 c21))
;(categoryorder (c21 c23))
(categoryorder (c18 c23))
(categoryorder (c23 c19))

;(categoryorder (c0 c1 c2))
;(categoryorder (c3 c5))
;(categoryorder (c2 c3))
;(categoryorder (c4 c0))

(dominance (s0 s1 s2 s3 s4))

(categoryset somecats (c0 c1 c2 c3 c4 (c5 c10))) 

(sensitivitycategory s0 (c0 c1 c2 c3 c4 (c5 c10)))

(level SystemHigh (s0 ((c0 c2) c3 c4 c5 (c6 c10))))

(attribute mlsfilereadtoclr)
(attribute mlsfileread)
(attribute mlstrustedobject)

(mlsconstrain (file)
	(ioctl read write create getattr setattr lock)
	(|| (|| (dom l1 l2)(&& (== t1 mlsfilereadtoclr)(dom h1 l2)))(|| (== t1 mlsfileread)(== t2 mlstrustedobject))))

;(mlsconstrain (file)
;	(read write open)
;	(|| (domby l1 l2) (== t1 t2)))

(block apache
	(type process)
	(type tmp)
	(role apache_r)
	(typealias .apache.tmp apache_t)(type log)
	(typealias .foo apache_alias)
	(typealias pid apache_pid)
	(typealias foo apache_foo)
	(typealias foo.bar apache_test)
	(type pid)
	(type user_cgi)

	(block test
		(type test1)
		(type test2))
	(block three
		(type testing)
		(type testing2))
	(block four
		(type test)
		(type test4))
	(block foo
		(type foo)
		(type bar))


	(allow process log file (read open))

)
(boolean foo true)
(boolean bar false)

(type my_t)

(class dir
	(read write execute))

(auditallow apache.process .apache.log file (write))
(dontaudit new foobar file (open))
(neverallow my_t bar file (read))
