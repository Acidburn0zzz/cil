(type bar)
(type qaz)
(class file (read))
(macro m ((type foo)(type bar))
	(type baz)
	(block c
		(type hi))
	(allow foo c.hi file (read))
	(allow foo .bar file (read))
	(allow baz .b.boz file (read))
	(block d
		(type hd))
	(allow baz d.hd file (read))
	(allow foo qaz file (read)))
(block b
	(type boz)
	(call m (boz .c.moo)))
(block c
	(type moo))
