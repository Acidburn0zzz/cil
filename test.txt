(block apache
			(type process)
			(role apache_r)
			(typealias apache apache_t)(type log)
			(type pid)
			(type user_cgi)
			(attribute httpd_sys_content)
			(attribute cgi_script)

			(interface read_log (x:type)
				(allow x log (file dir) (read getattr)))

			(typeattribute user_cgi (cgi_script))
			(domain_type process)

			(allow process log file (read write))

			(corenet_tcp_sendrecv_all_nodes process))

		(bool foo true)
		(bool bar false)

		; object classes
		(class file
			(read write open))

		; local.cil

		(type my_t)

		(allow my_t apache.log (file dir) (read getattr))

		; replace all calls to corenet_tcp_sendrecv_all_nodes
		(template (match block[@name=apache]/ifcall[@ifname=corenet_tcp_sendrecv_all_nodes])
			(ifcall corenet_tcp_sendrecv_generic_nodes (value-of @ifname)))

		; replace using a slightly different syntax
		(template (match block[@name=apache])
			(for-each (select ifcall[@ifname=corenet_tcp_sendrecv_all_nodes))
			(ifcall corenet_tcp_sendrecv_generic_nodes (value-of @ifname)))

		; IN

		(in apache
			(allow process bar file write))

		(in apache.read_log
			(allow x log file write))

